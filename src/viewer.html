<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Markdown Viewer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
</head>
<body>
    <div id="content"></div>
    <button onclick="window.location.href='../index.html';">返回目录</button>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                packages: {'[+]': ['ams']},
                tags: 'ams'
            },
            chtml: {
                scale: 0.9
            },
            startup: {
                ready: () => {
                    console.log('MathJax is ready');
                    MathJax.startup.defaultReady();
                    loadMarkdown();
                }
            }
        };

        function loadMarkdown() {
            const query = new URLSearchParams(window.location.search);
            const path = query.get('file');
            if (path) {
                fetch('../' + path)
                    .then(response => response.text())
                    .then(text => {
                        const contentElement = document.getElementById('content');
                        if (!contentElement) {
                            console.error('Content element not found');
                            return;
                        }
                        contentElement.innerHTML = marked.parse(text);
                        Prism.highlightAll();
                        MathJax.typesetPromise().then(() => {
                            console.log('MathJax has typeset the content');
                        }).catch(err => console.error('MathJax typesetting error:', err));
                    })
                    .catch(err => {
                        console.error('Failed to load or process markdown file:', err);
                    });
            } else {
                console.error('No file specified in the URL query parameters');
            }
        }
    </script>
</body>
</html>
